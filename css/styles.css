:root{
  --bg:#0b1220; --panel:#0f172a; --ink:#e5e7eb; --muted:#94a3b8; --border:#1f2937;
}
*{box-sizing:border-box}
html,body,#app{height:100%}
body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif}

#app{display:grid;grid-template-columns:320px 1fr;position:relative}
.panel{padding:16px;background:var(--panel);border-right:1px solid var(--border);overflow:auto}
main#map{position:relative}
.detail-panel{
  position:fixed;
  top:0;right:0;bottom:0;
  width:300px;
  background:var(--panel);
  border-left:1px solid var(--border);
  padding:16px;
  box-shadow:-12px 0 24px rgba(0,0,0,0.35);
  display:none;
  z-index:1000;
  overflow:auto;
}
.detail-panel.open{display:block}
.detail-close{
  position:absolute;top:8px;right:8px;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--ink);
  border-radius:50%;
  width:28px;height:28px;
  cursor:pointer;
}
.detail-header{display:flex;align-items:center;gap:8px;margin-bottom:10px;}
.detail-header h3{margin:0;font-size:16px}
.detail-actions{display:flex;gap:6px}
.detail-actions button{
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--ink);
  padding:4px 8px;
  border-radius:6px;
  cursor:pointer;
}
.compare-list{display:grid;gap:10px}
.compare-card{border:1px solid var(--border);border-radius:8px;padding:8px;background:rgba(255,255,255,0.02)}
.compare-card h4{margin:0 0 4px;font-size:14px}
.compare-rows{display:grid;gap:4px;font-size:13px;color:var(--ink)}
.compare-rows .label{color:var(--muted)}
.compare-row{display:flex;justify-content:space-between;align-items:center;gap:6px}
.compare-bar{height:6px;border-radius:4px;background:var(--border);overflow:hidden;flex:1;margin-left:6px}
.compare-bar span{display:block;height:100%}
h1{margin:0 0 10px;font-size:28px}
.controls{display:grid;gap:6px;margin:10px 0 12px}
.controls .control-row{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.controls .boxmode-row{flex-wrap:nowrap;justify-content:flex-start}
.controls .boxmode-row label{margin-right:12px}
.controls label{display:flex;align-items:center;gap:8px}
.controls select{
  background:var(--panel);
  color:var(--ink);
  border:1px solid var(--border);
  border-radius:6px;
  padding:6px 8px;
}
.factor-toggle{
  --accent:#0ea5e9;
  appearance:none;
  -webkit-appearance:none;
  width:16px;height:16px;
  border:1px solid var(--border);
  border-radius:4px;
  background:var(--panel);
  display:inline-grid;
  place-content:center;
  cursor:pointer;
}
.factor-toggle:focus-visible{outline:2px solid var(--accent);outline-offset:2px}
.factor-toggle:checked{
  background:var(--accent);
  border-color:var(--accent);
}
.factor-toggle:checked::after{
  content:"";
  width:5px;height:9px;
  border:2px solid #fff;
  border-top:0;border-left:0;
  transform:rotate(45deg);
}
.factor-toggle[value="gdp_pc"]{--accent:#60a5fa}
.factor-toggle[value="unemployment"]{--accent:#fb923c}
.factor-toggle[value="alloc_pct_gdp"]{--accent:#eab308}
#resetBtn{
  margin-top:6px;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--ink);
  padding:6px 10px;
  border-radius:6px;
  cursor:pointer;
}

#map{height:100%;width:100%;background:#0b1220}

/* Country picker */
.country-picker{
  border:1px solid var(--border);
  border-radius:10px;
  background:var(--panel);
  min-width:240px;
  color:var(--ink);
  overflow:hidden;
  transition:box-shadow .2s ease,border-color .2s ease;
}
.country-picker summary{
  padding:10px 12px;
  cursor:pointer;
  list-style:none;
  font-weight:600;
  outline:none;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
  background:linear-gradient(120deg, rgba(14,165,233,0.08), rgba(14,165,233,0.02));
}
.country-picker summary:after{
  content:"▾";
  font-size:12px;
  color:var(--muted);
  transition:transform .2s ease,color .2s ease;
}
.country-picker[open] summary:after{transform:rotate(180deg);color:var(--ink)}
.country-picker summary::-webkit-details-marker{display:none}
.country-picker:hover{border-color:#1e40af;box-shadow:0 10px 24px rgba(0,0,0,0.25)}
.country-picker[open]{box-shadow:0 16px 26px rgba(0,0,0,0.32)}
.country-picker-body{border-top:1px solid var(--border);padding:8px 10px 12px;display:grid;gap:10px}
.country-picker-search{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.country-picker-search input{
  flex:1;
  background:var(--bg);
  color:var(--ink);
  border:1px solid var(--border);
  border-radius:6px;
  padding:6px 8px;
}
.country-picker-search span{font-size:12px;color:var(--muted)}
.country-picker-actions{display:flex;gap:8px}
.country-picker-actions button{
  flex:1;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--ink);
  padding:8px 10px;
  border-radius:8px;
  cursor:pointer;
  transition:background .15s ease,border-color .15s ease,transform .12s ease;
}
.country-picker-actions button:first-child{border-color:#22c55e;background:rgba(34,197,94,0.1)}
.country-picker-actions button:last-child{border-color:#ef4444;background:rgba(239,68,68,0.08)}
.country-picker-actions button:hover{transform:translateY(-1px);border-color:#38bdf8}
.country-picker-list{max-height:220px;overflow:auto;display:grid;gap:4px}
.country-picker-list label{display:flex;align-items:center;gap:8px;padding:6px 6px;border-radius:8px;transition:background .12s ease,border-color .12s ease}
.country-picker-list label:hover{background:#1f2937}

/* Country labels */
/* Country labels – white pill under the minis */
.country-label {
  pointer-events: none;
}

.country-label span {
  position: relative;
  left: 50%;
  transform: translateX(-50%);
  display: inline-block;
  white-space: nowrap;

  padding: 2px 8px;
  border-radius: 999px;

  background: #0b1220;
  color: #e5e7eb;
  font-size: 11px;
  line-height: 1.2;

  box-shadow:
    0 0 0 1px rgba(14, 165, 233, 0.25),
    0 3px 8px rgba(0, 0, 0, 0.35);
}



/* Legends (if you keep them visible) */
.legend{font-size:12px;color:var(--ink)}
.legend text{fill:var(--ink)}
.legend-title{font-weight:600;fill:var(--ink)}
.legend-tick{fill:var(--muted)}

/* Minis */
.mini rect{shape-rendering:crispEdges;vector-effect:non-scaling-stroke}
.leaflet-overlay-pane .flow-arrow{
  opacity:0;
  transition:opacity .25s ease;
}
.leaflet-overlay-pane .flow-arrow.arrow-visible{opacity:0.9}
.leaflet-overlay-pane .flow-arrow.arrow-fade{opacity:0}

/* Nuke any legacy box overlays */
.country-box-group, .country-box, .boxes-root{
  display:none !important;
  pointer-events:none !important;
}
